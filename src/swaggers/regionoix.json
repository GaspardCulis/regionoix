{"openapi":"3.1.0","info":{"title":"regionoix-backend","description":"","license":{"name":"MIT","identifier":"MIT"},"version":"0.1.0"},"paths":{"/api/admin/product/upload":{"post":{"tags":["Admin"],"summary":"Upload new product","operationId":"upload","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/UploadForm"}}},"required":true},"responses":{"200":{"description":"Uploaded sucessfully"},"400":{"description":"Invalid data"},"401":{"description":"Unauthorized"},"500":{"description":"Upload error"}}}},"/api/auth/login":{"post":{"tags":["Authentification"],"summary":"Logs user in","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Logged in successfully"},"404":{"description":"Email not found"}}}},"/api/auth/logout":{"post":{"tags":["Authentification"],"summary":"Logs user out","operationId":"logout","responses":{"200":{"description":"Logged out successfully"}}}},"/api/auth/register":{"post":{"tags":["Client"],"summary":"Create new client","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterForm"}}},"required":true},"responses":{"200":{"description":"Registered sucessfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoggedUser"}}}},"400":{"description":"Password is too short, should be at least 8 caracters long.","content":{"text/plain":{"schema":{"type":"string"}}}},"500":{"description":"Register error","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/api/auth/status":{"get":{"tags":["Authentification"],"summary":"Get user authentication status","operationId":"status","responses":{"200":{"description":"","content":{"Application/Json":{"schema":{"$ref":"#/components/schemas/LoggedUser"}}}}}}},"/api/basket":{"get":{"tags":["Basket"],"summary":"Returns basket details of current user","operationId":"get","responses":{"200":{"description":"Basket details successfully returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CartDto"}}}}}},"delete":{"tags":["Basket"],"summary":"Empty current user's basket","operationId":"empty","responses":{"200":{"description":"Basket successfully emptied","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/api/basket/count":{"get":{"tags":["Basket"],"summary":"Returns basket count of current user","description":"Returns count of differents products in cart of current user.","operationId":"get","responses":{"200":{"description":"Basket count successfully returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CountBasket"}}}}}}},"/api/basket/items":{"post":{"tags":["Basket"],"summary":"Add product to basket of current user","operationId":"add","requestBody":{"content":{"Application/Json":{"schema":{"$ref":"#/components/schemas/FormAddToBasket"}}},"required":true},"responses":{"200":{"description":"Product successfully added to basket","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CartLineDto"}}}}}}},"/api/basket/items/{product_id}":{"delete":{"tags":["Basket"],"summary":"Remove product from current user's basket","operationId":"remove","parameters":[{"name":"product_id","in":"path","description":"Product id","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"Product successfully removed from basket","content":{"text/plain":{"schema":{"type":"string"}}}}}},"patch":{"tags":["Basket"],"summary":"Update quantity of product in current user's basket","operationId":"update_quantity","parameters":[{"name":"product_id","in":"path","description":"Product id","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"Application/Json":{"schema":{"$ref":"#/components/schemas/FormUpdateQuantityBasket"}}},"required":true},"responses":{"200":{"description":"Basket details successfully returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CartLineDto"}}}}}}},"/api/basket/order":{"post":{"tags":["Basket"],"summary":"Make order from current user's basket","operationId":"make","requestBody":{"content":{"Application/Json":{"schema":{"$ref":"#/components/schemas/FormDataMakeOrder"}}},"required":true},"responses":{"200":{"description":"Order successfully created","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/api/brands":{"get":{"tags":["Brands"],"summary":"Returns brands","operationId":"get","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Brands successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BrandDto"}},"example":[{"description":null,"id":1,"name":"Jaaj Corp"},{"description":null,"id":2,"name":"Isère confitures"}]}}}}}},"/api/categories":{"get":{"tags":["Categories"],"summary":"Returns category list","operationId":"get","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Product list successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CategoryDto"}},"example":[{"category_parent":null,"description":null,"id":1,"name":"Confitures"},{"category_parent":null,"description":null,"id":2,"name":"Miels"}]}}}}}},"/api/categories/hierarchy":{"get":{"tags":["Categories"],"summary":"Returns categories with hierarchy","operationId":"get_parents","responses":{"200":{"description":"Categories hierarchy successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CategoryDto"}},"example":[{"childs":[{"category_parent":1,"description":null,"id":2,"name":"Confitures"}],"description":null,"id":1,"name":"Epicerie sucrée"}]}}}}}},"/api/health":{"get":{"summary":"Get API health. Checks all connector services.","operationId":"health","responses":{"200":{"description":"All services online","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/api/orders":{"get":{"tags":["Orders"],"summary":"Returns orders","description":"Orders for current user","operationId":"get","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Orders successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrderDto"}}}}}}}},"/api/orders/in-progress":{"get":{"tags":["Orders"],"summary":"Returns order list in progress","description":"Orders in progress for current user","operationId":"get_in_progress","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Order list in progress successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrderDto"}}}}}}}},"/api/orders/past":{"get":{"tags":["Orders"],"summary":"Returns completed order list","description":"Orders completed for current user","operationId":"get_past","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Order completed list successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrderDto"}}}}}}}},"/api/products":{"get":{"tags":["Products"],"summary":"Returns product list","operationId":"get","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Product list successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProductDto"}},"example":[{"brand_id":5,"category_id":null,"description":"Super confiture","discount":null,"id":1,"image":"/product1.jpg","name":"Confiture du triève","price":5.8,"region_id":1,"stock":10,"weight":0.6}]}}}}}},"/api/products/{id}":{"get":{"tags":["Products"],"summary":"Returns single product","operationId":"get_by_id","parameters":[{"name":"id","in":"path","description":"Product id","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"Product successfully returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductDto"},"example":[{"brand":{"description":null,"id":3,"name":"Jaaj Coorp"},"category":{"category_parent":6,"id":7,"name":"Confiture"},"description":"Super confiture","id":1,"image":"/product1.jpg","name":"Confiture du triève","price":5.8,"region":{"description":null,"id":1,"name":"Auvergne"},"stock":10,"weight":0.6}]}}}}}},"/api/regions":{"get":{"tags":["Regions"],"summary":"Returns region list","operationId":"get","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Region list successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RegionDto"}},"example":[{"description":null,"id":1,"name":"Auvergne-Rhône-Alpes"},{"description":null,"id":2,"name":"Grand Est"}]}}}}}},"/api/search/products":{"get":{"tags":["Products"],"summary":"Search for products","operationId":"search","parameters":[{"name":"query","in":"query","description":"The raw search query","required":true,"schema":{"type":"string"}},{"name":"filters","in":"query","description":"Search filters in this example form: `id > 1 AND genres = Action`.\nThe list of filterable attributes is `[\"weight\", \"price\", \"categories\", \"tags\", \"brand_name\", \"region_name\"]`.\nSee the [Meilisearch filter expression reference](https://www.meilisearch.com/docs/learn/filtering_and_sorting/filter_expression_reference#filter-expression-reference) for more info.","required":false,"schema":{"type":["string","null"]}},{"name":"sort","in":"query","description":"Sort by some specific attribute in the format `attribute:method` where `method: asc | desc`.\nEx: `price:asc`.\nThe list of sortable attributes is `[\"name\", \"price\", \"weight\"]`.\nSee the [Meilisearch sorting API](https://www.meilisearch.com/docs/reference/api/search#sort) for more info.","required":false,"schema":{"type":["string","null"]}},{"name":"page_size","in":"query","description":"Number of results per page in a search. Defaults to 128 results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from 1. Defaults to 1.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Products successfully searched and returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProductDto"}}}}}}}},"/api/tags":{"get":{"tags":["Tags"],"summary":"Returns tag list","operationId":"get","parameters":[{"name":"page_size","in":"query","description":"Number of results in a page. Defaults to all results.","required":false,"schema":{"type":["integer","null"],"minimum":0}},{"name":"page_index","in":"query","description":"Specific page to fetch; page index starts from zero. Defaults to zero.","required":false,"schema":{"type":["integer","null"],"minimum":0}}],"responses":{"200":{"description":"Tag list successfully returned","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TagDto"}},"example":[{"id":1,"name":"Vegan"},{"id":2,"name":"Végétarien"}]}}}}}}},"components":{"schemas":{"AddressDto":{"type":"object","required":["id","city","country","street","postal_code","lastname","firstname"],"properties":{"city":{"type":"string"},"country":{"type":"string"},"firstname":{"type":"string"},"id":{"type":"integer","format":"int32"},"lastname":{"type":"string"},"postal_code":{"type":"string"},"street":{"type":"string"}}},"BrandDto":{"type":"object","required":["id","name"],"properties":{"description":{"type":["string","null"]},"id":{"type":"integer","format":"int32"},"name":{"type":"string"}}},"CartDto":{"type":"object","required":["id","user_id"],"properties":{"id":{"type":"integer","format":"int32"},"lines":{"type":["array","null"],"items":{"$ref":"#/components/schemas/CartLineDto"},"description":"Won't be fectched unless `finalize` is called."},"user_id":{"type":"integer","format":"int32"}}},"CartLineDto":{"type":"object","required":["id","cart_id","product","quantity"],"properties":{"cart_id":{"type":"integer","format":"int32"},"id":{"type":"integer","format":"int32"},"product":{"$ref":"#/components/schemas/ProductDto"},"quantity":{"type":"integer","format":"int32"}}},"CategoryDto":{"type":"object","required":["id","name"],"properties":{"category_parent":{"type":["integer","null"],"format":"int32"},"childs":{"type":["array","null"],"items":{"$ref":"#/components/schemas/SubCategoryDto"}},"description":{"type":["string","null"]},"id":{"type":"integer","format":"int32"},"name":{"type":"string"}}},"CountBasket":{"type":"object","required":["count"],"properties":{"count":{"type":"integer","format":"int32"}}},"DiscountDto":{"type":"object","required":["id","percentage_off","end_date"],"properties":{"end_date":{"type":"string","format":"date"},"id":{"type":"integer","format":"int32"},"percentage_off":{"type":"integer","format":"int32"}}},"FormAddToBasket":{"type":"object","required":["product_id"],"properties":{"product_id":{"type":"integer","format":"int32"},"quantity":{"type":["integer","null"],"format":"int32"}}},"FormDataMakeOrder":{"type":"object","required":["firstname","lastname","city","country","postal_code","street"],"properties":{"city":{"type":"string"},"country":{"type":"string"},"firstname":{"type":"string"},"lastname":{"type":"string"},"postal_code":{"type":"string"},"street":{"type":"string"}}},"FormUpdateQuantityBasket":{"type":"object","required":["quantity"],"properties":{"quantity":{"type":"integer","format":"int32"}}},"LoggedUser":{"type":"object","required":["id","email","role"],"properties":{"email":{"type":"string"},"firstname":{"type":["string","null"]},"id":{"type":"integer","format":"int32"},"lastname":{"type":["string","null"]},"role":{"$ref":"#/components/schemas/Roles"}}},"LoginRequest":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string"},"password":{"type":"string"}}},"OrderDto":{"type":"object","required":["id","total_price","adress"],"properties":{"adress":{"$ref":"#/components/schemas/AddressDto"},"arrival_date":{"type":["string","null"],"format":"date"},"creation_date":{"type":["string","null"],"format":"date"},"id":{"type":"integer","format":"int32"},"order_lines":{"type":["array","null"],"items":{"$ref":"#/components/schemas/OrderLineDto"},"description":"Won't be fectched unless `finalize` is called."},"status":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/OrderStatus"}]},"total_price":{"type":"number","format":"float"},"user_id":{"type":["integer","null"],"format":"int32"}}},"OrderLineDto":{"type":"object","required":["id","quantity","unit_price","product"],"properties":{"id":{"type":"integer","format":"int32"},"order_id":{"type":["integer","null"],"format":"int32"},"product":{"$ref":"#/components/schemas/ProductDto"},"quantity":{"type":"integer","format":"int32"},"unit_price":{"type":"number","format":"float"}}},"OrderStatus":{"type":"string","enum":["PendingPayment","Payed","InDelivery","Delivered","Canceled","Aborted"]},"ProductDto":{"type":"object","required":["id","name","price","stock"],"properties":{"brand":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/BrandDto"}]},"category":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/CategoryDto"}]},"description":{"type":["string","null"]},"discount":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/DiscountDto"}]},"id":{"type":"integer","format":"int32"},"image":{"type":["string","null"]},"name":{"type":"string"},"price":{"type":"number","format":"float"},"region":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/RegionDto"}]},"stock":{"type":"integer","format":"int32"},"tags":{"type":["array","null"],"items":{"$ref":"#/components/schemas/TagDto"},"description":"Won't be fectched unless `finalize` is called."},"weight":{"type":["number","null"],"format":"double"}}},"RegionDto":{"type":"object","required":["id","name"],"properties":{"description":{"type":["string","null"]},"id":{"type":"integer","format":"int32"},"name":{"type":"string"}}},"RegisterForm":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string"},"firstname":{"type":["string","null"]},"lastname":{"type":["string","null"]},"password":{"type":"string"}}},"Roles":{"type":"string","enum":["Client","Admin"]},"SubCategoryDto":{"type":"object","required":["id","name"],"properties":{"category_parent":{"type":["integer","null"],"format":"int32"},"description":{"type":["string","null"]},"id":{"type":"integer","format":"int32"},"name":{"type":"string"}}},"TagDto":{"type":"object","required":["id","name"],"properties":{"id":{"type":"integer","format":"int32"},"name":{"type":"string"}}},"UploadForm":{"type":"object","required":["image","meta"],"properties":{"image":{"type":"string","format":"binary","contentMediaType":"application/octet-stream"},"meta":{"type":"object","required":["name","price","stock","tags"],"properties":{"brand_id":{"type":["integer","null"],"format":"int32"},"category_id":{"type":["integer","null"],"format":"int32"},"description":{"type":["string","null"]},"name":{"type":"string"},"price":{"type":"number","format":"float"},"region_id":{"type":["integer","null"],"format":"int32"},"stock":{"type":"integer","format":"int32"},"tags":{"type":"array","items":{"type":"integer","format":"int32"}},"weight":{"type":["number","null"],"format":"double"}}}}}}},"tags":[{"name":"Regionoix","description":"Regionoix API endpoints."}]}